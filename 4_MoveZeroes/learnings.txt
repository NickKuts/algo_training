Simple O(N) algorithm with O(1) space.
